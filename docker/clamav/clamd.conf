# ClamAV daemon configuration - optimized for container deployment
LocalSocket /var/run/clamav/clamd.ctl
FixStaleSocket true
LocalSocketGroup clamav
LocalSocketMode 666
User clamav

# Network configuration
TCPSocket 3310
TCPAddr 0.0.0.0
MaxConnectionQueueLength 30
MaxThreads 12

# Timeouts
ReadTimeout 180
CommandReadTimeout 30
SendBufTimeout 200
IdleTimeout 30

# Queue settings
MaxQueue 100

# Paths to exclude from scanning
ExcludePath ^/proc
ExcludePath ^/sys

# Scan settings
ScanPE true
ScanELF true
ScanMail false
ScanArchive true
ArchiveBlockEncrypted false
MaxDirectoryRecursion 15
FollowDirectorySymlinks false
FollowFileSymlinks false

# File limits
MaxFiles 10000
MaxFileSize 25M
MaxRecursion 10
MaxEmbeddedPE 10M
MaxHTMLNormalize 10M
MaxHTMLNoTags 2M
MaxScriptNormalize 5M
MaxZipTypeRcg 1M

# Self-check interval (1 hour)
SelfCheck 3600

# Logging
Foreground false
Debug false
LogFile /var/log/clamav/clamav.log
LogTime true
LogClean false
LogSyslog false
LogFacility LOG_LOCAL6
LogVerbose false
LogRotate true
LogFileMaxSize 10M

# Enhanced detection
ExtendedDetectionInfo true
ScanPDF true
ScanSWF true
ScanXMLDOCS true
ScanHWP3 true
ScanOLE2 true

# Performance optimizations
DatabaseDirectory /var/lib/clamav
TemporaryDirectory /tmp
DetectPUA false
AlgorithmicDetection true
CrossFilesystems true

# Disable bytecode for security
Bytecode false
BytecodeTimeout 60000
AlgorithmicDetection true
Bytecode true
BytecodeSecurity TrustSigned
BytecodeTimeout 60000
PhishingSignatures true
PhishingScanURLs true
PhishingAlwaysBlockSSLMismatch false
PhishingAlwaysBlockCloak false
HeuristicScanPrecedence false
StructuredDataDetection false
StructuredMinCreditCardCount 3
StructuredMinSSNCount 3
StructuredSSNFormatNormal true
StructuredSSNFormatStripped false
